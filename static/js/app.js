webpackJsonp([1],{"+skl":function(t,e){},"5Yvq":function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=a("7+uW"),s=a("7t+N"),r=a.n(s),o={name:"App",components:{},data:function(){return{path:this.$store.state.path_curent}},computed:{data:function(){var t=window.MENU;return this.formatMenu(t,"")}},mounted:function(){},methods:{formatMenu:function(t,e){var a=this,n=[];for(var s in t){var r={};isNaN(s)?(e=e+"/"+s,r.title=s,r.expand=!0,r.render=function(t,n){n.root,n.node;var s=n.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-folder-outline"},style:{marginRight:"8px"}}),t("a",{props:{type:"text"},on:{click:function(){a.getParent(e)}}},s.title)])])},r.children=this.formatMenu(t[s],e),n.push(r)):function(){var o=e+"/"+t[s];r.title=a.formatTitle(t[s]),r.render=function(t,e){e.root,e.node;var n=e.data;return t("span",{style:{display:"inline-block",width:"100%"}},[t("span",[t("Icon",{props:{type:"ios-paper-outline"},style:{marginRight:"8px"}}),t("a",{props:{type:"text"},on:{click:function(){a.goto(o)}}},n.title)])])},n.push(r)}()}return n},formatTitle:function(t){var e=t.split("_");return t.replace(e[0]+"_","").replace(".qwk","")},goto:function(t){window.location.href="index.php?to="+encodeURIComponent(t)},getParent:function(t){"/add"!==this.$route.path||(this.$store.state.path_selected=t)},edit:function(){var t=this;r.a.ajax({url:"save.php",method:"post",type:"json",data:{file:window.CURPATH,action:"check"},success:function(e){0==e.err?t.$router.push({path:"/edit"}):t.$Message.error(e.msg)}})}}},i={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"layout"},[a("Layout",[a("Header",[a("Menu",{attrs:{mode:"horizontal",theme:"dark","active-name":"1"}},[a("div",{staticClass:"layout-logo"},[t._v("qWiKi")]),t._v(" "),a("div",{staticClass:"layout-nav"},[a("MenuItem",{attrs:{name:"1"}},[a("router-link",{attrs:{to:"/add"}},[a("Icon",{attrs:{type:"edit"}}),t._v("\n                        写文档\n                      ")],1)],1)],1)])],1),t._v(" "),a("Layout",[a("Sider",{style:{background:"#fff"},attrs:{"hide-trigger":""}},[a("Tree",{attrs:{data:t.data,render:t.renderContent}})],1),t._v(" "),a("Layout",{style:{padding:"0 24px 24px"}},[a("Breadcrumb",{style:{margin:"24px 0"}},t._l(t.$store.state.path_curent,function(e,n){return a("BreadcrumbItem",[t._v("\n                      "+t._s(e)+"\n                      "),n===t.$store.state.path_curent.length-1&&"/add"!==t.$route.path&&"/edit"!==t.$route.path?a("span",[a("a",{attrs:{href:"javascript:void(0);"},on:{click:t.edit}},[a("Icon",{attrs:{type:"compose"}})],1)]):t._e()])})),t._v(" "),a("Content",{style:{padding:"24px",minHeight:"280px",background:"#fff"}},[a("router-view")],1)],1)],1)],1)],1)},staticRenderFns:[]};var d=a("VU/8")(o,i,!1,function(t){a("5Yvq")},"data-v-0ffd1c60",null).exports,c=a("/ocq"),l=a("OS1Z"),p={name:"Index",data:function(){return{attachments:window.ATTACHMENTS}},computed:{html:function(){var t=window.HTML.html,e=l.markdownIt.render(t);return this.nl2br(e)}},methods:{nl2br:function(t,e){return(t+"").replace(/([^>\r\n]?)(\r\n|\n\r|\r|\n)/g,"$1"+(e||void 0===e?"<br />":"<br>")+"$2")}}},u={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("div",{domProps:{innerHTML:t._s(t.html)}}),t._v(" "),t.attachments.length>0?a("div",{staticClass:"attachs"},[a("div",[t._v("附件")]),t._v(" "),a("ul",t._l(t.attachments,function(e,n){return a("li",[a("a",{attrs:{href:"attachments/"+e.url,target:"_blank"}},[a("Icon",{attrs:{type:"android-attach"}}),t._v(" "+t._s(e.name))],1)])}))]):t._e()])},staticRenderFns:[]};var h=a("VU/8")(p,u,!1,function(t){a("chDs")},"data-v-3f8ea3b2",null).exports,m=a("mvHQ"),f=a.n(m),v=(a("pw1w"),{name:"Add",components:{mavonEditor:l.mavonEditor},data:function(){return{tag:0,title:"",attachments:[],default_files:[],html:"",edit:0}},mounted:function(){if("/add"===this.$route.path)this.$store.state.path_curent=["","新增文档"],this.$store.state.path_selected="/",this.edit=0;else{this.$store.state.path_curent=window.PATH;var t=window.PATH.slice(0,-1).join("/");this.$store.state.path_selected=(""===t?"/":"")+t,this.title=window.TITLE,this.default_files=window.ATTACHMENTS,this.attachments=window.ATTACHMENTS,this.html=window.HTML.html,this.edit=1}},methods:{$imgAdd:function(t,e){var a=new FormData;a.append("image",e),axios({url:"upload.php",method:"post",data:a,headers:{"Content-Type":"multipart/form-data"}}).then(function(e){$vm.$img2Url(t,e)})},successHandle:function(t,e,a){this.attachments.push(t.file),t.err>0&&this.$Message.error(t.msg)},errHandle:function(t,e,a){this.$Message.error(t)},removeFile:function(t,e){var a=-1;for(var n in e)e[n].name===t.name&&(a=n);-1!==a&&this.attachments.splice(a,1)},saveHtml:function(t){var e=this;r.a.ajax({url:"save.php",method:"post",type:"json",data:{path:this.$store.state.path_selected,title:this.title,content:t,attachments:f()(this.attachments),file:window.CURPATH,edit:this.edit},success:function(t){0==t.err?(e.$Message.success(t.msg),window.location.href="index.php?to="+t.to):e.$Message.error(t.msg)}})}}}),_={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"editor"}},[a("div",{staticClass:"mt15"},[a("Row",[a("Col",{attrs:{span:"8"}},[a("Input",{staticStyle:{width:"100%",height:"50"},attrs:{placeholder:"path"},model:{value:t.$store.state.path_selected,callback:function(e){t.$set(t.$store.state,"path_selected",e)},expression:"$store.state.path_selected"}})],1),t._v(" "),a("Col",{attrs:{span:"2"}}),t._v(" "),a("Col",{attrs:{span:"14"}},[a("Input",{staticStyle:{width:"100%",height:"50","margin-left":"20px"},attrs:{placeholder:"title"},model:{value:t.title,callback:function(e){t.title=e},expression:"title"}})],1)],1)],1),t._v(" "),a("div",{staticClass:"mt15"},[a("Upload",{attrs:{multiple:"false",type:"drag","on-error":t.errHandle,"on-success":t.successHandle,"on-remove":t.removeFile,"default-file-list":t.default_files,action:"upload.php"}},[a("div",{staticStyle:{padding:"20px 0"}},[a("Icon",{staticStyle:{color:"#3399ff"},attrs:{type:"ios-cloud-upload",size:"52"}}),t._v(" "),a("p",[t._v("Click or drag attachments here to upload")])],1)])],1),t._v(" "),a("div",{staticClass:"mt15"},[a("mavon-editor",{ref:"md",staticStyle:{height:"100%"},attrs:{value:t.html},on:{imgAdd:t.$imgAdd,save:t.saveHtml}})],1)])},staticRenderFns:[]};var w=a("VU/8")(v,_,!1,function(t){a("YKTh")},"data-v-688d69b2",null).exports;n.default.use(c.a);var g=new c.a({routes:[{path:"/",name:"Index",component:h},{path:"/add",name:"Add",component:w},{path:"/edit",name:"Add",component:w}]}),y=a("BTaQ"),$=a.n(y),T=(a("+skl"),a("NYxO"));n.default.config.productionTip=!1,n.default.use($.a),n.default.use(T.a);var x=new T.a.Store({state:{path_selected:"/",path_curent:window.PATH},mutations:{}});new n.default({el:"#app",router:g,store:x,components:{App:d},template:"<App/>"})},YKTh:function(t,e){},chDs:function(t,e){},pw1w:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.js.map